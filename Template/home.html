{% extends "base.vue" %}
{% load i18n %}
{% block title %}home{% endblock title %}

{% block content %}
{% trans '使用' as enter %}
    {% if false %}
        <cell cell_title="{% trans '更新公告' %}">
            <p>{% trans '說明： 將於 X/X X:X 時關閉伺服器進行系統更新，系統將會停止所有正在執行中的檔案，請您不要執行過大的檔案，以免被終止，預計於 X:X 時重新啟動伺服器，感謝您的使用' %}</p>
            <a href="{% url 'update_log' %}" class="btn btn-default btn-block">{% trans '更新預覽' %}</a>
        </cell>
    {% endif %}
    <cell cell_title="DPView: Differentially Private Synthetic Dataset Generation">
        <p>{% trans '說明： 差分隱私適用於資料筆數較大的資料集，建議至少含有一萬筆紀錄且維度也會受資料筆數影響不能太高。' %}</p>
        <a href="{% url 'DPView:home' %}" class="btn btn-default btn-block">{{ enter }}</a>
    </cell>
    <cell cell_title="k-Anonymity for De-Identifying Dataset">
        <a href="{% url 't_Closeness:home' %}" class="btn btn-default btn-block">{{ enter }}</a>
    </cell>
{% endblock content %}

{% block script %}
    <script>
        page.title = "{% trans '歡迎使用本系統' %}"
    </script>

    <script>
        $(function () {
            sidebar_highlight('home');
        })
        $(function () {
            var url = "{% url 'check_file_status' %}"
            $.getJSON(url, function (request) {
                if (request == null) {
                    var url = "{% url 'initialize' %}"
                    $.get(url);
                } else if (request.finish == true) {
                    next = true
                    while (next) {
                        if (confirm("{% trans '檔案去識別化完成，是否查看執行結果?' %}")) {
                            next = false
                            window.location = request.url;
                        } else {
                            if (confirm("{% trans '確定執行新的去識別化嗎?先前的執行結果將不會保留' %}")) {
                                next = false
                                $.get("{% url 'initialize' %}");
                            }
                        }
                    }
                } else if (request.finish == false) {
                    next = true
                    while (next) {
                        if (confirm("{% trans '檔案執行中，是否查看執行進度?' %}")) {
                            next = false
                            window.location = request.url;
                        } else {
                            if (confirm("{% trans '確定執行新的去識別化嗎?先前的執行進度將不會保留' %}")) {
                                next = false
                                $.get(request.break_url);
                                $.get("{% url 'initialize' %}");
                            }
                        }
                    }
                } else {
                    alert("{% trans 'home.html finish不符合預期，請通知開發人員，finish = ' %}"+request.finish);
                }
            })
        })
    </script>
{% endblock script %}